{% load static %}
<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1" />
<title>{% block title %}DailySoul{% endblock %}</title>
<link href="https://fonts.googleapis.com/css2?family=Poppins:wght@300;400;500;600;700&display=swap" rel="stylesheet">
<style>
:root {
  --bg1: #e8f5e9;
  --bg2: #fff3e0;
  --accent: #77bfa3;
  --accent-dark: #5fa88d;
  --accent-light: #e8f5e9;
  --muted: #555;
  --muted-light: #777;
  --card-bg: #ffffff;
  --radius: 16px;
  --max-container-width: 1400px;
}
* { box-sizing: border-box; margin: 0; padding: 0; }
html, body { height: 100%; font-family: 'Poppins', sans-serif; scroll-behavior: smooth; overflow-x: hidden; }
body { background: linear-gradient(135deg, var(--bg1), var(--bg2)); color: #222; line-height: 1.6; min-height: 100vh; }
.page-container { display: flex; flex-direction: column; align-items: center; min-height: 100vh; padding: 30px 20px 40px; width: 100%; }
main { max-width: var(--max-container-width); width: 100%; margin: 0 auto; flex: 1; }

.navbar { width: 100%; max-width: var(--max-container-width); display: flex; justify-content: space-between; align-items: center; background-color: var(--card-bg); padding: 20px 30px; border-radius: var(--radius); box-shadow: 0 6px 25px rgba(0,0,0,0.08); margin-bottom: 35px; position: relative; z-index: 1000; }
.navbar .logo { color: var(--accent); font-weight: 700; font-size: 1.6rem; }

.nav-links { display: flex; align-items: center; }
.nav-links ul { list-style: none; display: flex; gap: 5px; }
.nav-links a { text-decoration: none; color: var(--muted); padding: 12px 18px; font-weight: 500; font-size: 1rem; border-radius: 8px; transition: all 0.3s ease; }
.nav-links a:hover { color: var(--accent-dark); background-color: var(--accent-light); transform: translateY(-2px); }

.mega-menu-item { position: relative; cursor: pointer; }
.arrow-down { font-size: 0.7em; margin-left: 5px; transition: transform 0.3s ease; }
.mega-menu-item.open .arrow-down { transform: rotate(180deg); }

.mega-menu-content { display: none; position: absolute; top: calc(100% + 8px); left: 50%; transform: translateX(-50%) translateY(-10px); width: 500px; background-color: var(--card-bg); box-shadow: 0 15px 40px rgba(0,0,0,0.12); border-radius: var(--radius); padding: 25px; z-index: 1000; gap: 25px; border-top: 4px solid var(--accent); opacity: 0; transition: all 0.3s ease; }
.mega-menu-item.open .mega-menu-content { display: flex; opacity: 1; transform: translateX(-50%) translateY(0); }

.menu-column { flex: 1; display: flex; flex-direction: column; }
.menu-column h3 { font-size: 1.05rem; color: var(--accent-dark); margin-bottom: 15px; }
.menu-column a { padding: 8px 0; font-weight: 400; color: var(--muted-light); border-radius: 6px; padding-left: 8px; }
.menu-column a:hover { color: var(--accent); padding-left: 12px; background-color: #f8f9fa; }

.mobile-toggle { display: none; background: transparent; border: none; font-size: 1.4rem; cursor: pointer; padding: 8px; border-radius: 6px; }
.mobile-toggle:hover { background-color: #f5f5f5; }

.mobile-nav { display: none; position: fixed; inset: 0; align-items: flex-start; justify-content: flex-end; z-index: 15000; background: rgba(0,0,0,0.4); backdrop-filter: blur(4px); }
.mobile-drawer { width: 92%; max-width: 380px; background: var(--card-bg); height: 100vh; padding: 20px; box-shadow: -8px 0 40px rgba(0,0,0,0.15); transform: translateX(100%); transition: transform 0.35s ease; display: flex; flex-direction: column; gap: 15px; overflow-y: auto; }
.mobile-nav.open { display: flex; }
.mobile-drawer.open { transform: translateX(0); }
.mobile-drawer .close-btn { align-self: flex-end; background: transparent; border: 0; font-size: 1.4rem; cursor: pointer; padding: 8px; border-radius: 6px; }
.mobile-drawer nav { display: flex; flex-direction: column; gap: 5px; }
.mobile-drawer nav a { display: block; padding: 14px 12px; color: var(--muted); text-decoration: none; border-radius: 10px; font-weight: 500; transition: all 0.2s ease; }
.mobile-drawer nav a:hover { background: #f5f5f5; color: var(--accent-dark); transform: translateX(5px); }

</style>
</head>
<body>

<div class="page-container">

  <nav class="navbar">
    <div style="display:flex; align-items:center; gap:12px;">
      <h2 class="logo">DailySoul</h2>
    </div>

    <div class="nav-links">
      <ul>
        <li><a href="{% url 'dashboard' %}">Home</a></li>
        <li><a href="/journal/">Journal</a></li>
        <li><a href="/deathnote/">DeathNote</a></li>

        <li class="mega-menu-item" id="megaItem">
          <span id="miniGamesNav">Mini-Games <span class="arrow-down">▼</span></span>
          <div class="mega-menu-content">
            <div class="menu-column">
              <h3>Mind Games</h3>
              <a href="{% url 'bubble_pop' %}">Bubble Pop</a>
              <a href="/games/crossword/">Daily Crossword</a>
              <a href="/games/memory/">Memory Match</a>
              <a href="{% url 'mini_games' %}">Browse All Games</a>
            </div>
          </div>
        </li>

        <li><a href="{% url 'logout' %}">Logout</a></li>
      </ul>
    </div>

    <button class="mobile-toggle" id="mobileToggle">☰</button>
  </nav>

  <div class="mobile-nav" id="mobileNav">
    <div class="mobile-drawer" id="mobileDrawer">
      <button class="close-btn" id="mobileClose">✕</button>
      <nav>
        <a href="{% url 'dashboard' %}">Home</a>
        <a href="/journal/">Journal</a>
        <a href="/deathnote/">DeathNote</a>
        <a href="{% url 'logout' %}">Logout</a>
      </nav>
    </div>
  </div>

  <main>
    {% block content %}
    <section id="miniGamesSection" style="margin-top:1000px;">
      <h2>Mini Games Section</h2>
      <p>Here are your games...</p>
    </section>
    {% endblock %}
  </main>
</div>

<script>
const miniNav = document.getElementById('miniGamesNav');
const megaItem = document.getElementById('megaItem');
const section = document.getElementById('miniGamesSection');

let isOpen = false;
miniNav.addEventListener('click', function() {
  if(!isOpen) {
    megaItem.classList.add('open');
    isOpen = true;
    const y = section.getBoundingClientRect().top + window.pageYOffset - 20;
    window.scrollTo({top: y, behavior: 'smooth'});
  } else {
    megaItem.classList.remove('open');
    isOpen = false;
    window.scrollTo({top: 0, behavior: 'smooth'});
  }
});

// Mobile drawer
const mobileToggle = document.getElementById('mobileToggle');
const mobileNav = document.getElementById('mobileNav');
const mobileDrawer = document.getElementById('mobileDrawer');
const mobileClose = document.getElementById('mobileClose');

function openMobile(){ mobileNav.classList.add('open'); mobileDrawer.classList.add('open'); document.body.style.overflow='hidden'; }
function closeMobile(){ mobileNav.classList.remove('open'); mobileDrawer.classList.remove('open'); document.body.style.overflow=''; }

if(mobileToggle) mobileToggle.addEventListener('click', ()=>{ mobileNav.classList.contains('open') ? closeMobile() : openMobile(); });
if(mobileClose) mobileClose.addEventListener('click', closeMobile);
if(mobileNav) mobileNav.addEventListener('click', e => { if(e.target === mobileNav) closeMobile(); });
</script>
</body>
</html>
